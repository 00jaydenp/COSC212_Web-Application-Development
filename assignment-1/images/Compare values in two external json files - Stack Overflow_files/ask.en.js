"use strict";StackExchange.ready(function(){function e(){var e=u.data("validation-errors"),n=u.data("validation-warnings");(e||n)&&StackExchange.postValidation.showErrorsAfterSubmission(u,d.Question,v,e,n)}function n(e,n,t){b&&StackExchange.using("gps",function(){StackExchange.gps.track(e,n,t),t&&j.trigger()})}function t(e,t,a){a.forEach(function(a){e.one(a,function(){n("question.action",{"action_type":t+"_"+a},!0)})})}function a(e,n){try{C||(_.removeClass("dno"),StackExchange.editor.finallyInit(),C=!0,u.data("delay-validation")||StackExchange.using("postValidation",function(){StackExchange.postValidation.initOnBlur(_,d.Answer,"post",!1)})),I.fadeTo(e?0:400,1,n)}catch(t){setTimeout(function(){a(e,n)},10)}}function s(){var e=V.find('[data-kp="'+(StackExchange.options.site.routePrefix||"")+'"]').index();V.prop("selectedIndex",e)}function i(){O.addClass("is-loading"),StackExchange.cardiologist.ensureDraftSaved(function(){},!0),StackExchange.postValidation.validatePostFields(u,d.Question,v,!1,function(){return $(".js-visible-before-review").fadeOut().promise()}).then(function(){u.data("delay-validation",!1),StackExchange.postValidation.initOnBlurAndSubmit(u,d.Question,v,!1),q.is(":checked")&&(StackExchange.postValidation.initOnBlur(_,d.Answer,"post",!1),StackExchange.postValidation.validatePostFields(_,d.Answer,"post",!1))}).then(function(){$(".js-visible-during-review").removeClass("d-none").hide().fadeIn(),StackExchange.postValidation.scrollToErrors()}).fail(function(){O.removeClass("is-loading")})}function o(e){var n=[],t=function(e){for(var t=0,a=e;t<a.length;t++){var s=a[t];-1===n.indexOf(s)&&n.push(s)}};return t(e.Title),t(e.Body),t(e.Tags),n}function r(){P||(P=$('<input name="distinctErrorCount" type="hidden">').appendTo(u),B=$('<input name="distinctWarningCount" type="hidden">').appendTo(u),N=$('<input name="unresolvedWarningCount" type="hidden">').appendTo(u));var e=A.namedWarnings.map(function(e){return e.bodies});A.unnamedWarnings&&e.push(A.unnamedWarnings),P.val(A.distinctErrorCount),B.val(e.length),N.val(e.filter(function(e){return o(e).length>0}).length)}function c(){function e(e,t){var a=o(t),r=a.length>0,c=$("<div>").html(n.find(".js-warning-template").text());c.find(".js-guidance-title").text(e),c.find(".js-separator").toggleClass("d-none",i.is(":empty")),c.find(".js-success-icon").toggleClass("d-none",r),c.find(".js-warning-icon").toggleClass("d-none",!r);var d=c.find(".js-guidance-body").toggleClass("d-none",!r);if(r){s=!1;for(var u=0,l=a;u<l.length;u++){var g=l[u];$('<div class="grid--cell" />').html(g).appendTo(d)}}d.find("a").attr("target","_blank"),c.children().appendTo(i)}var n=$(".js-post-review-summary");if(0!==n.length&&A.loaded.Title&&A.loaded.Body&&A.loaded.Tags){var t=A.errors.Title+A.errors.Body+A.errors.Tags,a=!!A.unnamedWarnings||A.namedWarnings.length>0;n.find(".js-loading-message").addClass("d-none"),n.find(".js-success-no-warnings").toggleClass("d-none",t>0||a),n.find(".js-error-container").toggleClass("d-none",0===t),n.find(".js-warning-and-error-separator").toggleClass("d-none",0===t||!a),n.find(".js-warning-container").toggleClass("d-none",!a),t>0&&n.find(".js-error-message").text(function(e){return 1==e.__count,"Resolve "+e.__count+" issues before posting"}({"__count":t}));for(var s=0===t,i=n.find(".js-warning-list").empty(),r=0,c=A.namedWarnings;r<c.length;r++){var d=c[r];e(d.name,d.bodies)}A.unnamedWarnings&&e("Other suggestions",A.unnamedWarnings),n.find(".js-resolved-warnings-message").toggleClass("d-none",!s),n.find(".js-unresolved-warnings-message").toggleClass("d-none",s)}}StackExchange.helpers.removeParameterFromQueryString("fromen");var d=StackOverflow.Models.PostTypeId,u=$(".js-post-form"),l=u.find(".js-post-title-field"),g=u.find(".js-post-body-field[data-post-type-id="+d.Question+"]"),h=u.find(".js-post-tags-field"),f=u.find(".js-post-body-field[data-post-type-id="+d.Answer+"]"),p=u.find(".js-similar-questions"),v=u.data("form-type")||"question";u.data("delay-validation")||StackExchange.using("postValidation",function(){u.data("has-answer")||e(),StackExchange.postValidation.initOnBlurAndSubmit(u,d.Question,v,!1)});var m={"siteName":document.title.substr(document.title.indexOf(" - ")+3),"onResults":function(e){null!==e&&b&&(n("question_ask.suggestions_show",{}),StackExchange.using("gps",function(){e.addClass("js-gps-track").data("gps-track","question_ask.suggestion_click similarquestions.title_link_clicked"),StackExchange.gps.bindTrackClicks(p)}))}};StackExchange.question.initTitleSearch(l,p,m);var k=$(".js-ask-public"),x=$(".js-submit-button"),w=$(".js-question-form-overlay"),E=!1;w.length>0&&(E=!0,w.find(":input").prop("disabled",E)),k.change(function(){var e=this.checked;E=!e,k.prop("checked",e),x.prop("disabled",!e),w.toggleClass("pe-none o30",!e).find(":input").prop("disabled",!e)}),$(".js-tag-suggestions").length>0&&StackExchange.using("tagSuggestions",function(){StackExchange.tagSuggestions.init()});var y=u.data("required-tags");y&&StackExchange.using("tagEditor",function(){StackExchange.tagEditor.requiredTags=y});var S=u.data("force-heartbeat-at-body-length");S&&StackExchange.using("editor",function(){var e=setInterval(function(){g.val().length>=S&&(clearInterval(e),StackExchange.cardiologist.beatASAP())},3e3)});var b=u.data("enable-analytics"),T=u.data("enable-warning-analytics"),j=StackExchange.helpers.DelayedReaction(function(){return StackExchange.gps.sendPending()},3e3);n("question_ask.visit",{"inbox_subscription":u.data("inbox-subscription"),"referrer":u.data("referrer")}),t(l,"title",["blur"]),t(g,"body",["focus","blur"]),t(h,"tags",["focus","blur"]);var q=$(".js-post-answer-while-asking-checkbox"),C=!1,_=$("#question-answer-section"),W=$(".js-show-on-question-only"),I=$(".js-show-on-question-and-answer");q.change(function(){var e=q.get(0);e.disabled=!0,q.is(":checked")?W.fadeOut(function(){a(!1,function(){f.focus(),e.disabled=!1})}):I.fadeOut(function(){W.fadeIn(function(){e.disabled=!1})})}),(q.is(":checked")||u.data("has-answer"))&&(q.attr("checked","checked"),W.hide(),StackExchange.using("editor",function(){setTimeout(function(){a(!0,e)},2)}));var V=$(".js-inline-channel-switcher");V.length>0&&($(window).on("load",s),V.off("change"),V.on("change",function(){var e=V.val();if(e&&e.length){var n=l.val().length>0||g.val().length>0||f.val().length>0;if(n){var t=StackExchange.options.user.fkey,a=t.lastIndexOf("/");a>=0&&(t=t.substr(a+1));var i=V.find(":selected").data("kp");i&&i.length&&(t=i+"/"+t);var o=$('#post-form input[name="fkey"]'),r=o.val();o.val(t),w.find(":input").prop("disabled",!E);var c=$("#post-form").serialize();w.find(":input").prop("disabled",E),o.val(r),$.ajax({"url":e+"/save-draft","type":"POST","data":c,"success":function(){window.onbeforeunload=null,$.post("/post/discard-draft",{"fkey":StackExchange.options.user.fkey,"postType":"ask"}),window.location=e},"error":function(){s();var e={"position":{"my":"left top","at":"right center"},"css":{"width":"200px"}};StackExchange.helpers.showErrorMessage($(".js-inline-channel-switcher"),"An error occurred. Please try again later.",e)},"doNotRewriteUrl":!0})}else window.location=e}return!1}));var O=$(".js-begin-review-button");O.click(i),u.on("post:will-submit",function(e){O.length>0&&u.data("delay-validation")&&(e.preventDefault(),i())});var A={"loaded":{"Title":!1,"Body":!1,"Tags":!1},"errors":{"Title":0,"Body":0,"Tags":0},"namedWarnings":[],"observedErrors":{},"distinctErrorCount":0};u.on("post:validated-field",function(e,t){if(t.postTypeId===d.Question){var a=t.field;if("Title"===a||"Body"===a||"Tags"===a){A.loaded[a]=!0,A.errors[a]=t.errors.length,t.errors.forEach(function(e){A.observedErrors[e]||(A.observedErrors[e]=!0,A.distinctErrorCount+=1)});var s={},i=[];t.warnings.forEach(function(e){var n=$("<div>").html(e),t=n.get(0).childNodes;if(t.length<3||"B"!==t[0].nodeName||"BR"!==t[1].nodeName||$(t[0]).children().length>0)return i.push(e),void 0;for(var a=$(t[0]).remove().text();n.children().first().is("br");)n.children().first().remove();var o=$.trim(n.html());return 0===o.length?(i.push(e),void 0):(s[a]||(s[a]=[]),s[a].push(o),void 0)}),A.namedWarnings.forEach(function(e){e.bodies[a]=s[e.name]||[],delete s[e.name]});for(var o in s){var u={"name":o,"bodies":{"Title":[],"Body":[],"Tags":[]}};u.bodies[a]=s[o],A.namedWarnings.push(u),T&&n("question_ask.warning_show",{"name":o},!0)}(A.unnamedWarnings||i.length>0)&&(A.unnamedWarnings||(A.unnamedWarnings={"Title":[],"Body":[],"Tags":[]},T&&n("question_ask.warning_show",{},!0)),A.unnamedWarnings[a]=i),r(),c()}}}),u.on("post:submit-completed",function(e,t){t.response.success&&b&&T&&StackExchange.gps&&(A.namedWarnings.forEach(function(e){n("question_ask.warning_resolution",{"name":e.name,"resolved":0===o(e.bodies).length},!0)}),A.unnamedWarnings&&n("question_ask.warning_resolution",{"resolved":0===o(A.unnamedWarnings).length},!0))});var P,B,N});